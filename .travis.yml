language: python
python:
- '3.6'
env:
  global:
  - TC_HOME=$HOME/tc
  - MBED_BUILD_TIMESTAMP=42
matrix:
  include:
  - os: linux
    env: MBED_CLOUD=1.5.0 ARMGCC_VERSION=6.3.1
  - os: linux
    env: MBED_CLOUD=2.0.1.1 ARMGCC_VERSION=6.3.1
  - os: linux
    env: MBED_CLOUD=2.0.1.1 ARMGCC_VERSION=7.3.1
before_install:
- pip install -U pip wheel
- pip install mbed-cli
- mbed deploy
- "./toolchain_install.sh"
script:
- ". ./mbed-cloud-build.sh && cloudbuild cloud_client ${MBED_CLOUD}"
cache:
  directories:
  - "${TC_HOME}"
  - "${HOME}/.mbed/mbed-cache"
deploy:
  skip_cleanup: true
  provider: releases
  api_key:
    secure: RKMVvTEPcC2k1BGa2V8nu4ccVAC9OOasWJpzkZzmz1WtaOnS5qfZQO6c+jYe6ZjDIVgpOMSMh+3WKm+KXKdEAP04ZiGNLagiWO/04dnCwYk1qCly7Zguk2AquhfMSxU0TQ5TkRiHd7VjkZKpJ8MrgQMM086bTl9E0fseA1FtZuFrkYJ3buJPk7kmvzpNw54Y6glmjlALmXYsJXE6LonkRua9jwVCyMbO8TDfxjdZOE8lZ9Wox4LOYPR1Ef/mHkdFcUekc92UYdDBR4SGTOrK6/BHFqEAFWCx3VSkQrolMxretunnAXd4uewJrRg4ZLuF2G02vJgYMORD0YEjvd5QBqPr3OxyET3Ol4azXkKe8/003L5ijzyP/mc3TbNLm2cGmTIhWFjf79XwxWjL+Z3EfAawRO2BPXPFMAKiiS9zIsZf8NTO1XstS1/9GQbraIhRtUAsTfJwzidAv2ewFa07IgkwFaaAFkeQyzZsORHT6rJ1Tbwalc+2IEWVgGGYbGfrcZsV/f8f11DHJmOeEkrkl02mhNjXxFgbgSzwIJWunptHsxqFqJChprqS+dmURvhveaTH67wKcAUWsPJ8R44kATGKD01Sk8FjWAKDtk4h4lAO4bo2OWbxqQy9W0NZPtMNKQTXe4dojFOa4autx2bK7gNsDS8xu5L55ibbAS1KQhE=
  file:
    - cloudbuild/BUILD
  on:
    all_branches: true
